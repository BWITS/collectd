# {{ ansible_managed }}
# In this section we define all the plugins which requires more than one directive

{% if item.plugin == "apache" %}
# Apache plugin
<Plugin "{{ item.plugin }}">
   <Instance "{{ item.Instance }}">
       URL "{{ item.Url }}"
   </Instance>
</Plugin>
{% endif %}

{% if item.plugin == "network" and item.Forward == "true" %}
# Network plugin in forward mode
<Plugin "{{ item.plugin }}">
Listen "{{ item.Listen }}"
Server "{{ item.Server }}"
Forward {{ item.Forward }}
</Plugin>
{% endif %}

{% if item.plugin == "write_graphite" %}
# Write to Graphite
<Plugin "{{ item.plugin }}">
       <Carbon>
               Host "{{ item.Host }}"
               Port "{{ item.Port }}"
               Prefix "{{ item.Prefix }}"
               Postfix "{{ item.Postfix }}"
               SeparateInstances {{ item.SeparateInstances }}
               StoreRates {{ item.StoreRates }}
               AlwaysAppendDS {{ item.AlwaysAppendDS }}
               EscapeCharacter "{{ item.EscapeCharacter }}"
       </Carbon>
</Plugin>
{% endif %}

# {{ ansible_managed }}
